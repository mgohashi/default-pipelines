pipeline {
  parameters {
    string(name: 'NAMESPACE', description: 'What is the project name?')
    string(name: 'APP_NAME', description: 'What is the application name?')
    string(name: 'GIT_URL', description: 'What is the Git repository?')
  }
  agent any
  stages {
    stage('Checkout') {
      steps {
        script {
          echo "Checkout source code from ${GIT_URL}..."
        }
      }
    }
    stage('Configurar Build') {
      steps {
        script {
          echo "NAMESPACE=${NAMESPACE}"
          echo "APP_NAME=${APP_NAME}"
        }
      }
    }
    stage('Build') {
      steps {
        script {
          echo "Application build..."
        }
      }
    }
    stage('Unit Tests') {
      steps {
        script {
          echo "Running unit tests..."
        }
      }
    }
    stage('Static Analysis') {
      steps {
        script {
          echo "Running analysis..."
        }
      }
    }
    stage('Export Nexus') {
      steps {
        script {
          echo "Exporting to nexus..."
        }
      }
    }
    stage('Deployment') {
      steps {
        script {
          if (true) {
            stage('Aprovar') {
              input {
                  message "Você gostaria de aprovar?"
                  ok "Sim, gostaria."
                  submitter "aprovadores"
                  submitterParameter "USERNAME" 
              }
              steps {
                script {
                  echo "Olá aprovador ${USERNAME}"
                }
              }
            }
            stage('Promover') {
              input {
                  message "Você gostaria de promover?"
                  ok "Sim, gostaria."
                  submitter "deployers"
                  submitterParameter "USERNAME" 
              }
              steps {
                script {
                  echo "Olá implantador ${USERNAME}"
                }
              }
            }
            stage('Finalizando') {
              steps {
                script {
                  echo "Deploying to production..."
                }
              }
            }
          }//if
        }//scripts
      } //steps
    }//stage
  }//stages
}//pipeline